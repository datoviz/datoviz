/*************************************************************************************************/
/*  FPS                                                                                          */
/*************************************************************************************************/

#ifndef DVZ_HEADER_FPS
#define DVZ_HEADER_FPS



/*************************************************************************************************/
/*  Includes                                                                                    */
/*************************************************************************************************/

#include "_math.h"
#include "_time.h"



/*************************************************************************************************/
/*  Constants                                                                                    */
/*************************************************************************************************/

#define DVZ_FPS_MAX_COUNT 2000
#define DVZ_FPS_BINS      100
#define DVZ_FPS_HEIGHT    50.0f



/*************************************************************************************************/
/*  Typedefs                                                                                     */
/*************************************************************************************************/

typedef struct DvzFps DvzFps;



/*************************************************************************************************/
/*  Enums                                                                                        */
/*************************************************************************************************/


/*************************************************************************************************/
/*  Structs                                                                                      */
/*************************************************************************************************/

struct DvzFps
{
    DvzClock clock;
    uint64_t counter;
    uint32_t count; // number of values in delays
    dvec2 min_max;
    double* values;
    float* hist;
};



EXTERN_C_ON

/*************************************************************************************************/
/*  FPS functions                                                                                */
/*************************************************************************************************/

DVZ_EXPORT DvzFps dvz_fps(void);



DVZ_EXPORT void dvz_fps_tick(DvzFps* fps);



DVZ_EXPORT void dvz_fps_destroy(DvzFps* fps);



/**
 * Display a FPS histogram.
 */
DVZ_EXPORT void dvz_fps_histogram(DvzFps* fps);



EXTERN_C_OFF

#endif
